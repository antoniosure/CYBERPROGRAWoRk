import reuqests 
import json


#Estos son los links del api
#CHECK IP -> https://www.abuseipdb.com/check/[IP]/json?key=[API_KEY]&days=[DAYS]
#CHECK CIDR -> https://www.abuseipdb.com/check-block/json?network=[CIDR]&key=[API_KEY]&days=[DAYS]
#REPORT IP -> https://www.abuseipdb.com/report/json?key=[API_KEY]&category=[CATEGORIES]&comment=[COMMENT]&ip=[IP]

opc=int(input("""Ingresa la opcion que desees: [1] Para checar si una IP ha sido colocado en la lista negra de IP´S maliciosas
                [2] Para checar el CIDR ("Familia de Ip´s maliciosas")
                [3] Para reportar una IP maliciosa."""

if opc == '1':
  print("Usted entro a la opción de checar si la IP esta en la lista negra de IP´S maliciosas")
    
     url = 'https://api.abuseipdb.com/api/v2/blacklist'

    querystring = {
        'confidenceMinimum':'90'
    }
  with open('apikey.txt', 'r') as archivo:
    llave = archivo.read() 
    headers = {
        'Accept': 'application/json',
        'Key': llave
    }

response = requests.request(method='GET', url=url, headers=headers, params=querystring)

# Formatted output
decodedResponse = json.loads(response.text)
print json.dumps(decodedResponse, sort_keys=True, indent=4)

if opc == '2': 
  print("Usted ingreso a la opción de checar la familia siguiented de la IP ingresada")
  import requests
import json

# Defining the api-endpoint
url = 'https://api.abuseipdb.com/api/v2/check-block'

querystring = {
    'network':'127.0.0.1/24',
    'maxAgeInDays':'15',
}

headers = {
    'Accept': 'application/json',
    'Key': 'YOUR_OWN_API_KEY'
}

response = requests.request(method='GET', url=url, headers=headers, params=querystring)

# Formatted output
decodedResponse = json.loads(response.text)
print json.dumps(decodedResponse, sort_keys=True, indent=4)

if opc == '3': 
  print("Usted ingreso al la opcion para reportar alguna ip")

# Defining the api-endpoint
url = 'https://api.abuseipdb.com/api/v2/report'

# String holding parameters to pass in json format
params = {
    'ip':'180.126.219.126',
    'categories':'18,20',
    'comment':'SSH login attempts with user root.'
    'timestamp':'2023-10-18T11:25:11-04:00'
}

headers = {
    'Accept': 'application/json',
    'Key': 'YOUR_OWN_API_KEY'
}

response = requests.request(method='POST', url=url, headers=headers, params=params)

# Formatted output
decodedResponse = json.loads(response.text)
print json.dumps(decodedResponse, sort_keys=True, indent=4)




"""
1	DNS Compromise	Altering DNS records resulting in improper redirection.
2	DNS Poisoning	Falsifying domain server cache (cache poisoning).
3	Fraud Orders	Fraudulent orders.
4	DDoS Attack	Participating in distributed denial-of-service (usually part of botnet).
5	FTP Brute-Force	
6	Ping of Death	Oversized IP packet.
7	Phishing	Phishing websites and/or email.
8	Fraud VoIP	
9	Open Proxy	Open proxy, open relay, or Tor exit node.
10	Web Spam	Comment/forum spam, HTTP referer spam, or other CMS spam.
11	Email Spam	Spam email content, infected attachments, and phishing emails. Note: Limit comments to only relevent information (instead of log dumps) and be sure to remove PII if you want to remain anonymous.
12	Blog Spam	CMS blog comment spam.
13	VPN IP	Conjunctive category.
14	Port Scan	Scanning for open ports and vulnerable services.
15	Hacking	
16	SQL Injection	Attempts at SQL injection.
17	Spoofing	Email sender spoofing.
18	Brute-Force	Credential brute-force attacks on webpage logins and services like SSH, FTP, SIP, SMTP, RDP, etc. This category is seperate from DDoS attacks.
19	Bad Web Bot	Webpage scraping (for email addresses, content, etc) and crawlers that do not honor robots.txt. Excessive requests and user agent spoofing can also be reported here.
20	Exploited Host	Host is likely infected with malware and being used for other attacks or to host malicious content. The host owner may not be aware of the compromise. This category is often used in combination with other attack categories.
21	Web App Attack	Attempts to probe for or exploit installed web applications such as a CMS like WordPress/Drupal, e-commerce solutions, forum software, phpMyAdmin and various other software plugins/solutions.
22	SSH	Secure Shell (SSH) abuse. Use this category in combination with more specific categories.
23	IoT Targeted	Abuse was targeted at an "Internet of Things" type device. Include information about what type of device was targeted in the comments. """
